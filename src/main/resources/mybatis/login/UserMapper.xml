<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.muye.user.mapper.UserMapper">

    <resultMap id="userResult" type="cn.muye.user.domain.User">
        <result property="id" column="ID"/>
        <result property="userName" column="USER_NAME"/>
        <result property="password" column="PASSWORD"/>
        <result property="emailAddress" column="EMAIL_ADDRESS"/>
        <result property="sex" column="SEX"/>
        <!--<result property="passwordChangeRequired" column="PASSWORD_CHANGE_REQUIRED"/>-->
        <!--<result property="receiveEmail" column="RECEIVE_EMAIL"/>-->
        <!--<result property="registered" column="REGISTERED"/>-->
        <result property="deactivated" column="DEACTIVATED"/>
        <result property="lastVisit" column="LAST_VISIT"/>
        <result property="userRoleId" column="USER_ROLE_ID"/>
        <!--<result property="appKey" column="APP_KEY"/>-->
        <!--<result property="appSecret" column="APP_SECRET"/>-->
        <result property="phone" column="PHONE"/>
        <result property="company" column="COMPANY"/>
        <result property="level" column="LEVEL"/>
    </resultMap>

    <sql id="Base_Column_List">
      ID, USER_NAME, PASSWORD, EMAIL_ADDRESS, SEX, LAST_VISIT, COMPANY, PHONE,USER_ROLE_ID,LEVEL
    </sql>

    <select id="getUserById" resultMap="userResult">
        select
        <include refid="Base_Column_List"/>
        from D_USER u where u.ID = #{id}
    </select>

    <select id="getUserByName" resultMap="userResult">
        select
        <include refid="Base_Column_List"/>
        from D_USER u where u.USER_NAME = #{userName}
    </select>

    <select id="getUserInfoByUserPhone" resultMap="userResult">
        select
        <include refid="Base_Column_List"/>
        from D_USER u where u.PHONE = #{phone}
    </select>

    <select id="getUserList" resultMap="userResult">
        select
        <include refid="Base_Column_List"/>
        from D_USER where DEACTIVATED=0 ORDER BY ID desc
    </select>

    <insert id="save" useGeneratedKeys="true" keyProperty="id">
        insert into D_USER(
            USER_NAME,
            PASSWORD,
            SEX,
            EMAIL_ADDRESS,
            DEACTIVATED,
            LAST_VISIT,
            COMPANY,
            PHONE,
            USER_ROLE_ID,
            LEVEL
        ) values (
            #{userName},
            #{password},
            #{sex},
            #{emailAddress},
            #{deactivated},
            #{lastVisit},
            #{company},
            #{phone},
            #{userRoleId},
            #{level}
        )
  </insert>

    <update id="update">
        update D_USER SET
            USER_NAME = #{userName},
            PASSWORD = #{password},
            SEX = #{sex},
            EMAIL_ADDRESS = #{emailAddress},
            DEACTIVATED = #{deactivated},
            LAST_VISIT = #{lastVisit},
            COMPANY = #{company},
            PHONE = #{phone},
            USER_ROLE_ID = #{userRoleId},
            LEVEL= #{level}
        WHERE
          ID = #{id}
    </update>

    <delete id="deleteById">
        update D_USER set DEACTIVATED=1 where ID= #{id}
    </delete>

</mapper>